<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aerlo Exec – Voice Interview</title>
</head>
<body style="font-family:system-ui;max-width:900px;margin:40px auto;padding:0 16px;">
  <h1>Aerlo Exec – Voice Interview</h1>
  <button id="start" style="font-size:18px;padding:12px 18px;">Start</button>
  <textarea id="out" style="width:100%;min-height:280px;margin-top:20px;"></textarea>

<script>
document.getElementById("start").onclick = async () => {
  const pc = new RTCPeerConnection();

  const audio = document.createElement("audio");
  audio.autoplay = true;
  pc.ontrack = e => (audio.srcObject = e.streams[0]);

  const dc = pc.createDataChannel("events");
  dc.onmessage = e => {
    try {
      const msg = JSON.parse(e.data);
      if (msg.type === "response.output_text") {
        document.getElementById("out").value += msg.text + "\n";
      }
    } catch {}
  };

  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
  stream.getTracks().forEach(t => pc.addTrack(t, stream));

  const offer = await pc.createOffer();
  await pc.setLocalDescription(offer);

  const r = await fetch("/api/realtime", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ sdp: offer.sdp })
  });

  const answer = await r.text();
  await pc.setRemoteDescription({ type: "answer", sdp: answer });
};
</script>
</body>
</html>

